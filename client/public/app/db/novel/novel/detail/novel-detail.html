<div class="no-banner animated fadeIn">
  <div class="container">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a ui-sref="home">メインページ</a>
      </li>
      <li class="breadcrumb-item">
        <a>データベース</a>
      </li>
      <li class="breadcrumb-item">
        <a ui-sref="novel.list({ page: 1, length: null })">全てのノベル</a>
      </li>
      <li class="breadcrumb-item active">
        {{ vm.novel.title }}
      </li>
    </ol>
  </div>

  <div class="page-head">
    <div class="container">
      <h3>{{ vm.novel.title }}</h3>
      <h6>{{ vm.novel.titleEn }}</h6>
    </div>
  </div>

  <div class="container page-body db-novel-detail page-detail novel-detail item-container">
    <div class="body row">
      <div class="content col-lg-9">
        <div class="page-utility-container"
          novel-detail-utility 
          hide-nsfw="vm.hideNsfw" 
        >
        </div>
        
        <div class="item item-box">
          <div class="has-loading" 
            novel-detail-main-info 
            novel="vm.novel"
            hide-nsfw="vm.hideNsfw"
          >
          </div>
          
          <tag-in-novel class="col-12" tags="vm.novel.tags" novel="vm.novel"
            type="novel"></tag-in-novel>
        </div>
        <!-- <div class="row image-and-info-wrap">
          <div class="image col-lg-4 col-md-4 col-sm-4">
            <div class="image-wrap">
              <div class="image-placeholder ratio-3_4">
                <div image-thumb class="image-thumb"
                  condition="vm.hideNsfw && vm.novel.imageNsfw"
                  nsfw="/assets/img/image-nsfw.jpg" image="{{ vm.novel.image }}">
                </div>
              </div>
            </div>
            <div user-rating class="user-rating" novel="vm.novel.id" type="novel"></div>
            <h6 class="hidden-lg-up screenshots-nsfw-toggler toggler-left">
              Hコンテンツ
              <label class="switch-button" style="vertical-align: bottom;">
                <input type="checkbox" ng-model="vm.hideNsfw">
                <div class="slider"></div>
              </label>
            </h6>
          </div>

          <div class="info col-lg-8 col-md-8 col-sm-8">
            <table>
              <tr class="info-entry">
                <th class="hidden-sm-down">タイトル</th>
                <td>{{ vm.novel.title }}</td>
              </tr>
              <tr class="info-entry" ng-if="vm.novel.alias">
                <th class="hidden-sm-down">アリアス</th>
                <td>{{ vm.novel.alias }}</td>
              </tr>
              <tr class="info-entry" ng-if="vm.novel.length">
                <th class="hidden-sm-down">長さ</th>
                <td>{{ vm.length[vm.novel.length] }}</td>
              </tr>
              <tr class="info-entry" ng-if="vm.novel.producers">
                <th class="hidden-sm-down">プロヂューサー</th>
                <td>
                  <div ng-repeat="producer in vm.novel.producers">
                    {{ producer.name }}
                  </div>
                </td>
              </tr>
              <tr>
                <th colspan="2">デスクリプション</th>
              </tr>
              <tr>
                <td colspan="2">
                  <div class="description-wrap">
                    <p> </p>
                    <p id="novelDescription" ng-if="!vm.novel.description"
                      class="overflow-toggleable novel-descr">ディスクリプションがありません。</p>
                    <p id="novelDescription" ng-if="vm.novel.description"
                      class="overflow-toggleable novel-descr">{{ vm.novel.description }}</p>
                  </div>
                  <span class="see-more" toggle-overflow target="#novelDescription"
                    lines="6" font-size="1" role="button">
                    ▼もっと見る
                  </span>
                </td>
              </tr>
            </table>
          </div>

          <tag-in-novel class="col-12" tags="vm.novel.tags" novel="vm.novel"
            type="novel"></tag-in-novel>

          <div class="col-12">
            <div class="line-shadow full-width bottom"></div>
          </div>
        </div> -->

        <div class="more-info-tabs">
          <!-- Nav tabs -->
          <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item">
              <div class="nav-link active" data-toggle="tab" data-target="#character"
                role="button">
                キャラクター
              </div>
            </li>
            <li class="nav-item">
              <div class="nav-link" data-toggle="tab" data-target="#staff"
                role="button">
                スタフ
              </div>
            </li>
            <li class="nav-item">
              <div class="nav-link" data-toggle="tab" data-target="#release"
                role="button">
                発売
              </div>
            </li>
          </ul>

          <!-- Tab panes -->
          <div class="tab-content">
            <div class="tab-pane fade show active" id="character" role="tabpanel">
              <novel-detail-character class="character-list"
                characters="vm.novel.characters" novel="vm.novel">
              </novel-detail-character>
            </div>

            <div class="tab-pane fade" id="staff" role="tabpanel"
              ng-if="vm.novel.staffs">
              <table class="staff-container">
                <tr class="staff-group artist">
                  <th>Artist</th>
                  <td>
                    <staff-in-novel staffs="vm.novel.staffs.artist" type="artist"></staff-in-novel>
                  </td>
                </tr>
                <tr class="spacer"></tr>
                <tr class="staff-group scenario">
                  <th>Scenario</th>
                  <td>
                    <staff-in-novel staffs="vm.novel.staffs.scenario" type="scenario"></staff-in-novel>
                  </td>
                </tr>
                <tr class="spacer"></tr>
                <tr class="staff-group composer">
                  <th>Composer</th>
                  <td>
                    <staff-in-novel staffs="vm.novel.staffs.composer" type="composer"></staff-in-novel>
                  </td>
                </tr>
                <tr class="spacer"></tr>
                <tr class="staff-group vocals">
                  <th>Vocals</th>
                  <td>
                    <staff-in-novel staffs="vm.novel.staffs.vocals" type="vocals"></staff-in-novel>
                  </td>
                </tr>
                <tr class="spacer"></tr>
                <tr class="staff-group staff">
                  <th>Staffs</th>
                  <td>
                    <staff-in-novel staffs="vm.novel.staffs.staff" type="staff"></staff-in-novel>
                  </td>
                </tr>
              </table>

              <div class="add-group">
                <div>
                  <button class="add-more" type="button"></button>
                  <span>スタフを追加する</span>
                </div>
              </div>
            </div>

            <div class="tab-pane fade" id="release" role="tabpanel" ng-if="vm.novel.releases">
              <div class="release in-novel" ng-repeat="(releaseId, release) in vm.novel.releases">
                <h6>
                  {{ release.released || '?-?-?' }}
                  <span ng-switch="release.status">
                    <i ng-switch-when="trial" class="fa fa-spinner" title="Trial"></i>
                    <i ng-switch-when="complete" class="fa fa-check" title="Complete"></i>
                  </span>
                </h6>
                <div>
                  <div class="title expand-toggler" role="button" data-toggle="collapse"
                    aria-expanded="false" data-target="#release{{releaseId}}">
                    {{ release.title }}</div>
                  <div id="release{{releaseId}}" class="collapse release-detail">
                    <table>
                      <tbody>
                        <tr>
                          <th>年齢制限</th>
                          <td>
                            <span ng-if="release.ageRating == 0">全部</span>
                            <span ng-if="release.ageRating != 0">{{ release.ageRating }}+</span>
                          </td>
                          <td class="spacer"></td>
                          <th>ヴォイス</th>
                          <td>{{ release.voiced }}</td>
                        </tr>
                        <tr class="spacer"></tr>
                        <tr>
                          <th>アニメション(ストリ)</th>
                          <td>{{ release.animationStory }}</td>
                          <td class="spacer"></td>
                          <th>アニメション(18+)</th>
                          <td>{{ release.animationEro }}</td>
                        </tr>
                        <tr class="spacer"></tr>
                        <tr>
                          <th>プラットフォーム</th>
                          <td>{{ release.platform }}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <div class="crud-btn-group big">
                  <button class="crud-btn btn-edit">
                    <i class="fa fa-pencil"></i>
                  </button>
                  <button class="crud-btn btn-delete">
                    <i class="fa fa-times"></i>
                  </button>
                </div>
              </div>
              <span class="add-group">
                <div>
                  <button class="add-more" type="button"></button>
                  <span>リリースを追加する</span>
                </div>
              </span>
            </div>
          </div>
        </div>

        <section class="db-detail screenshot">
          <div class="head">
            <h6>スクリーンショット</h6>
            <h6 class="screenshots-nsfw-toggler toggler-right">
              Hコンテンツ
              <label class="switch-button" style="vertical-align: bottom;">
                <input type="checkbox" ng-model="vm.hideNsfw">
                <div class="slider"></div>
              </label>
            </h6>
          </div>
          <div class="add-more-screenshots">
            <button>
              <i class="fa fa-plus"></i>
              <span>追加する</span>
            </button>
          </div>
          <screenshot-in-novel ng-if="vm.novel.screenshots" hide-nsfw="vm.hideNsfw"
            screenshots="vm.novel.screenshots"></screenshot-in-novel>
          </section>

        <section class="db-detail review">
          <div class="head">
            <h6>レビューを書く</h6>
          </div>
          <review class="review-editor"></review>
        </section>
      </div>

      <aside class="col-lg-3 item-container">
        <div class="item-group">
          <h6>Quick tool</h6>
          <div class="item item-box quick-tool-group">
            <div class="nsfw">
              <span>
                <label class="switch-button">
                  <input type="checkbox" ng-model="vm.hideNsfw">
                  <div class="slider"></div>
                </label>
              </span>
              <span>Hコンテンツを消す</span>
            </div>
            <div class="btn-group">
              <button class="crud-btn btn-edit" ui-sref="novel.detail.edit"
                ui-sref-opts="{ reload: true }">
                <i class="fa fa-fw fa-pencil"></i>
              </button>
              <span>Edit article</span>
            </div>
            <div class="btn-group">
              <button class="crud-btn btn-delete" ng-click="vm.delete()">
                <i class="fa fa-fw fa-times"></i>
              </button>
              <span>Delete article</span>
            </div>
            <div class="btn-group">
              <button class="crud-btn btn-create" ui-sref="novel.new">
                <i class="fa fa-fw fa-plus"></i>
              </button>
              <span>New article</span>
            </div>
          </div>
        </div>
        <div class="item-group">
          <h6>
            スコア
            <span ng-if="vm.novel.rating" class="rating-score pull-right">
              <i class="fa fa-star"></i>
              <strong>{{ vm.novel.rating }}</strong>
              ({{ vm.novel.ratingsDetail.length }}人)
            </span>
          </h6>

          <div class="item item-box ratings-container">
            <div ng-if="!vm.novel.rating">
              このノベルには誰も評価しませんでした。
            </div>
            <div ng-if="vm.novel.rating" class="ratings-wrap true">
              <rating data="vm.novel.ratingsStatistics"></rating>
            </div>
          </div>
        </div>

        <div class="item-group">
          <h6>レビュー</h6>
          <ul uib-pagination total-items="vm.reviewTotalPage" ng-if="vm.novel.reviews"
            ng-model="vm.reviewPage" max-size="1" items-per-page="5"
            ng-change="vm.reviewPageChange()" boundary-links="true"
            first-text="最初" last-text="最後" next-text="»" previous-text="«"
            class="pull-right top">
          </ul>
          <div class="clearfix"></div>
          <div class="review-container">
            <div class="review item item-box" ng-if="!vm.novel.reviews">
              レビューが何もありません。
            </div>
            <div ng-if="vm.novel.reviews">
              <div class="review" ng-repeat="(reviewId, review) in vm.renderReviews">
                <h6>{{ review.title }}</h6>
                <p id="review{{reviewId}}" class="review-body overflow-toggleable">{{ review.body }}</p>
                <span toggle-overflow class="see-more" target="#review{{reviewId}}"
                  lines="3" font-size="1">▼もっと見る</span>
                <div>
                  <div class="image-placeholder ratio_1-1 avatar">
                    <div class="avatar-thumb image-thumb" ng-style="review.user.profileImage ? { 'background-image': 'url({{ review.user.profileImage }})' } : {}"></div>
                  </div>
                  <a ui-sref="index" class="username">
                    {{ review.user.userName }}さん
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </aside>
    </div>
  </div>
</div>

